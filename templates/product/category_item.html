{% comment %}
Ten szablon częściowy jest używany rekurencyjnie do wyświetlania struktury drzewiastej kategorii
{% endcomment %}
{% load product_tags %}

<tr class="{% if level > 0 %}category-child{% endif %}">
    <td>
        {% for i in level|get_range %}
            <span class="ms-3"></span>
        {% endfor %}
        
        {% if level > 0 %}
            <i class="fas fa-level-down-alt fa-rotate-90 text-muted me-2"></i>
        {% endif %}
        
        <span class="fw-{{ level|subtract_from:5 }}">{{ category.name }}</span>
    </td>
    <td>
        <span class="badge bg-info">{{ category.products.count }}</span>
    </td>
    <td>
        <span class="badge bg-secondary">{{ category.children.count }}</span>
    </td>
    <td>
        {% if category.is_active %}
            <span class="badge bg-success">Aktywna</span>
        {% else %}
            <span class="badge bg-secondary">Nieaktywna</span>
        {% endif %}
    </td>
    <td class="text-end">
        <div class="btn-group">
            <a href="{% url 'product:category_update' category.pk %}" class="btn btn-sm btn-outline-secondary" title="Edytuj">
                <i class="fas fa-edit"></i>
            </a>
            <a href="{% url 'product:category_delete' category.pk %}" class="btn btn-sm btn-outline-danger" title="Usuń">
                <i class="fas fa-trash"></i>
            </a>
        </div>
    </td>
</tr>

{% if show_children != False %}
    {% for child in category.children.all %}
        {% with level=level|add:1 %}
            {% include 'product/includes/category_item.html' with category=child %}
        {% endwith %}
    {% endfor %}
{% endif %}